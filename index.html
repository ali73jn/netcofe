<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¯ÛŒØ±ÛŒØª Ø¨ÙˆÚ©Ù…Ø§Ø±Ú©</title>
    <style>
        /* Reset Ùˆ ÙÙˆÙ†Øªâ€ŒÙ‡Ø§ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --spacing: 20px;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            background-image: url('data:image/svg+xml,<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" fill="rgba(255,255,255,0.1)"/></svg>');
            background-size: 20px 20px;
        }

        /* Ù‡Ø¯Ø± */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 15px 25px;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
        }

        .mode-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-weight: 500;
        }

        /* Ú¯Ø±ÛŒØ¯ Ø§ØµÙ„ÛŒ */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--spacing);
            padding: 10px;
        }

        /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            min-height: 200px;
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--glass-border);
        }

        .card-title {
            color: white;
            font-size: 18px;
            font-weight: 600;
        }

        .card-controls {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ú©Ø§Ø±Øª */
        .card-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .bookmark-item, .folder-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .bookmark-item:hover, .folder-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .item-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 5px;
        }

        .item-name {
            font-weight: 500;
            flex: 1;
        }

        .item-url {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
            direction: ltr;
            text-align: left;
        }

        .item-description {
            font-size: 12px;
            opacity: 0.8;
        }

        /* Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: white;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: white;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* Ø­Ø§Ù„Øª ÙˆÛŒØ±Ø§ÛŒØ´ */
        .edit-mode .card {
            cursor: move;
        }

        .edit-mode .resize-handle {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 15px;
            height: 15px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: nw-resize;
        }

        /* Ø¬Ø³ØªØ¬Ùˆ */
        .search-container {
            position: relative;
            flex: 1;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 10px 40px 10px 15px;
            border-radius: 25px;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            backdrop-filter: blur(10px);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Ù‡Ø¯Ø± -->
    <header class="header">
        <div class="search-container">
            <input type="text" class="search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¨ÙˆÚ©Ù…Ø§Ø±Ú©â€ŒÙ‡Ø§...">
            <span class="search-icon">ğŸ”</span>
        </div>
        
        <div class="header-controls">
            <div class="mode-toggle">
                <span>Ø­Ø§Ù„Øª Ù…Ø´Ø§Ù‡Ø¯Ù‡</span>
                <label class="switch">
                    <input type="checkbox" id="editModeToggle">
                    <span class="slider"></span>
                </label>
                <span>Ø­Ø§Ù„Øª ÙˆÛŒØ±Ø§ÛŒØ´</span>
            </div>
            <button class="btn" id="addCardBtn">+ Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯</button>
            <button class="btn btn-secondary" id="databaseBtn">Ù…Ø¯ÛŒØ±ÛŒØª Ø¯ÛŒØªØ§Ø¨ÛŒØ³</button>
        </div>
    </header>

    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
    <main>
        <div class="grid-container" id="cardsContainer">
            <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>
    </main>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Øª -->
    <div class="modal" id="addCardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯</h3>
                <button class="close-btn">&times;</button>
            </div>
            <form id="addCardForm">
                <div class="form-group">
                    <label for="cardName">Ù†Ø§Ù… Ú©Ø§Ø±Øª</label>
                    <input type="text" id="cardName" required>
                </div>
                <button type="submit" class="btn">Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Øª</button>
            </form>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§ÙØ²ÙˆØ¯Ù† Ø¨ÙˆÚ©Ù…Ø§Ø±Ú© -->
    <div class="modal" id="addBookmarkModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ø§ÙØ²ÙˆØ¯Ù† Ø¨ÙˆÚ©Ù…Ø§Ø±Ú© Ø¬Ø¯ÛŒØ¯</h3>
                <button class="close-btn">&times;</button>
            </div>
            <form id="addBookmarkForm">
                <div class="form-group">
                    <label for="bookmarkName">Ù†Ø§Ù…</label>
                    <input type="text" id="bookmarkName" required>
                </div>
                <div class="form-group">
                    <label for="bookmarkUrl">Ø¢Ø¯Ø±Ø³</label>
                    <input type="url" id="bookmarkUrl" required>
                </div>
                <div class="form-group">
                    <label for="bookmarkDescription">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
                    <textarea id="bookmarkDescription"></textarea>
                </div>
                <button type="submit" class="btn">Ø§ÙØ²ÙˆØ¯Ù† Ø¨ÙˆÚ©Ù…Ø§Ø±Ú©</button>
            </form>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¯ÛŒØªØ§Ø¨ÛŒØ³ -->
    <div class="modal" id="databaseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ù…Ø¯ÛŒØ±ÛŒØª Ø¯ÛŒØªØ§Ø¨ÛŒØ³</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button class="btn" id="downloadBtn">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³</button>
                <button class="btn btn-secondary" id="uploadBtn">Ø¢Ù¾Ù„ÙˆØ¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³</button>
            </div>
            <input type="file" id="fileInput" accept=".json" style="display: none;">
        </div>
    </div>

    <script>
        // Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù†Ù…ÙˆÙ†Ù‡
        let database = {
            version: "1.0",
            settings: {
                background: "default",
                gridSize: 20
            },
            cards: [
                {
                    id: "card_1",
                    name: "Ú©Ø§Ø±Øª Ù†Ù…ÙˆÙ†Ù‡",
                    position: { x: 0, y: 0 },
                    size: { width: 300, height: 250 },
                    items: [
                        {
                            type: "bookmark",
                            id: "bm_1",
                            name: "Ú¯ÙˆÚ¯Ù„",
                            url: "https://google.com",
                            description: "Ù…ÙˆØªÙˆØ± Ø¬Ø³ØªØ¬ÙˆÛŒ Ú¯ÙˆÚ¯Ù„",
                            favicon: ""
                        }
                    ]
                }
            ]
        };

        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
        function saveDatabase() {
            localStorage.setItem('bookmarkManagerDB', JSON.stringify(database));
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² localStorage
        function loadDatabase() {
            const saved = localStorage.getItem('bookmarkManagerDB');
            if (saved) {
                database = JSON.parse(saved);
            }
            renderCards();
        }

        // Ø±Ù†Ø¯Ø± Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
        function renderCards() {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';

            database.cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                cardElement.innerHTML = `
                    <div class="card-header">
                        <div class="card-title">${card.name}</div>
                        <div class="card-controls">
                            <button class="icon-btn" onclick="renameCard('${card.id}')">âœï¸</button>
                            <button class="icon-btn" onclick="addBookmarkToCard('${card.id}')">â•</button>
                            <button class="icon-btn" onclick="deleteCard('${card.id}')">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                    <div class="card-content">
                        ${card.items.map(item => `
                            <div class="${item.type}-item" onmouseenter="showTooltip(event, '${item.description}')" onmouseleave="hideTooltip()">
                                <div class="item-header">
                                    <div class="item-name">${item.name}</div>
                                    <div class="item-controls">
                                        <button class="icon-btn" onclick="editItem('${card.id}', '${item.id}')">âœï¸</button>
                                        <button class="icon-btn" onclick="deleteItem('${card.id}', '${item.id}')">ğŸ—‘ï¸</button>
                                    </div>
                                </div>
                                ${item.type === 'bookmark' ? `<div class="item-url">${item.url}</div>` : ''}
                                ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                            </div>
                        `).join('')}
                    </div>
                    <div class="resize-handle"></div>
                `;
                container.appendChild(cardElement);
            });
        }

        // ØªÙˆØ§Ø¨Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
        function addCard(name) {
            const newCard = {
                id: 'card_' + Date.now(),
                name: name,
                position: { x: 0, y: 0 },
                size: { width: 300, height: 250 },
                items: []
            };
            database.cards.push(newCard);
            saveDatabase();
            renderCards();
        }

        function deleteCard(cardId) {
            database.cards = database.cards.filter(card => card.id !== cardId);
            saveDatabase();
            renderCards();
        }

        function addBookmarkToCard(cardId) {
            document.getElementById('addBookmarkModal').style.display = 'flex';
            currentCardId = cardId;
        }

        // ØªÙˆØ§Ø¨Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨ÙˆÚ©Ù…Ø§Ø±Ú©â€ŒÙ‡Ø§
        function addBookmark(name, url, description) {
            const bookmark = {
                type: "bookmark",
                id: 'bm_' + Date.now(),
                name: name,
                url: url,
                description: description,
                favicon: ""
            };
            
            const card = database.cards.find(c => c.id === currentCardId);
            if (card) {
                card.items.push(bookmark);
                saveDatabase();
                renderCards();
            }
        }

        // ØªÙˆØ§Ø¨Ø¹ Ù…ÙˆØ¯Ø§Ù„
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ØªÙˆØ§Ø¨Ø¹ ØªÙˆÙ„ØªÛŒÙ¾
        function showTooltip(event, description) {
            if (!description) return;
            
            // Ø§ÛŒØ¬Ø§Ø¯ ØªÙˆÙ„ØªÛŒÙ¾
            const tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            tooltip.textContent = description;
            tooltip.style.cssText = `
                position: absolute;
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 12px;
                z-index: 1000;
                max-width: 200px;
                word-wrap: break-word;
            `;
            
            document.body.appendChild(tooltip);
            
            // Ù…ÙˆÙ‚Ø¹ÛŒØªâ€ŒØ¯Ù‡ÛŒ ØªÙˆÙ„ØªÛŒÙ¾
            const rect = event.target.getBoundingClientRect();
            tooltip.style.left = (rect.left + window.scrollX) + 'px';
            tooltip.style.top = (rect.top + window.scrollY - tooltip.offsetHeight - 10) + 'px';
            
            event.target.tooltip = tooltip;
        }

        function hideTooltip() {
            const tooltip = document.querySelector('.tooltip');
            if (tooltip) {
                tooltip.remove();
            }
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø¯ÛŒØªØ§Ø¨ÛŒØ³
        function downloadDatabase() {
            const dataStr = JSON.stringify(database, null, 2);
            const date = new Date().toISOString().replace(/[:.]/g, '-');
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `bookmark-database-${date}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function uploadDatabase(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const newDatabase = JSON.parse(e.target.result);
                    if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø¢Ù¾Ù„ÙˆØ¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¬Ø¯ÛŒØ¯ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                        database = newDatabase;
                        saveDatabase();
                        renderCards();
                        alert('Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¢Ù¾Ù„ÙˆØ¯ Ø´Ø¯!');
                    }
                } catch (error) {
                    alert('Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„!');
                }
            };
            reader.readAsText(file);
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            loadDatabase();
            
            // Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ø§Ù„Øª ÙˆÛŒØ±Ø§ÛŒØ´
            document.getElementById('editModeToggle').addEventListener('change', function(e) {
                document.body.classList.toggle('edit-mode', e.target.checked);
            });
            
            // Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Øª
            document.getElementById('addCardBtn').addEventListener('click', () => {
                showModal('addCardModal');
            });
            
            // ÙØ±Ù… Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Øª
            document.getElementById('addCardForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('cardName').value;
                addCard(name);
                hideModal('addCardModal');
                this.reset();
            });
            
            // ÙØ±Ù… Ø§ÙØ²ÙˆØ¯Ù† Ø¨ÙˆÚ©Ù…Ø§Ø±Ú©
            document.getElementById('addBookmarkForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('bookmarkName').value;
                const url = document.getElementById('bookmarkUrl').value;
                const description = document.getElementById('bookmarkDescription').value;
                addBookmark(name, url, description);
                hideModal('addBookmarkModal');
                this.reset();
            });
            
            // Ù…Ø¯ÛŒØ±ÛŒØª Ø¯ÛŒØªØ§Ø¨ÛŒØ³
            document.getElementById('databaseBtn').addEventListener('click', () => {
                showModal('databaseModal');
            });
            
            document.getElementById('downloadBtn').addEventListener('click', downloadDatabase);
            
            document.getElementById('uploadBtn').addEventListener('click', () => {
                document.getElementById('fileInput').click();
            });
            
            document.getElementById('fileInput').addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    uploadDatabase(e.target.files[0]);
                    this.value = '';
                }
            });
            
            // Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            // Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø®Ø§Ø±Ø¬
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.style.display = 'none';
                    }
                });
            });
        });

        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ
        let currentCardId = null;
    </script>
</body>
</html>